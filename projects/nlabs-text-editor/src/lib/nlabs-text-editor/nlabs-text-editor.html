<div class="editor-container" [class.dark-mode]="darkMode">
    <!-- Advanced Toolbar -->
    <div class="toolbar">
        <!-- Stil Seçimi -->
        <div class="toolbar-group">
            <select (change)="applyHeading($any($event.target).value)" class="heading-select">
                @for (heading of headingLevels; track $index) {
                @if ($index === 0) {
                <option [value]="heading.value">{{heading.text}}</option>
                }
                }
            </select>
        </div>

        <!-- Font Ailesi -->
        <div class="toolbar-group">
            <select (change)="applyFontFamily($any($event.target).value)" [value]="currentFontFamily"
                class="font-family-select">
                @for (font of fontFamilies; track $index) {
                <option [value]="font">{{font}}</option>
                }
            </select>
        </div>

        <!-- Font Boyutu -->
        <div class="toolbar-group">
            <select (change)="applyFontSize(+$any($event.target).value)" [value]="currentFontSize"
                class="font-size-select">
                @for (size of fontSizes; track $index) {
                <option [value]="size">{{size}}</option>
                }
            </select>
        </div>

        <!-- Format Butonları -->
        <div class="toolbar-group">
            <button type="button" (click)="toggleFormat('bold')" title="Kalın (Ctrl+B)" class="format-btn bold">
                <strong>B</strong>
            </button>
            <button type="button" (click)="toggleFormat('italic')" title="İtalik (Ctrl+I)" class="format-btn italic">
                <em>I</em>
            </button>
            <button type="button" (click)="toggleFormat('underline')" title="Altı Çizili (Ctrl+U)"
                class="format-btn underline">
                <u>U</u>
            </button>
            <button type="button" (click)="toggleFormat('strikeThrough')" title="Üstü Çizili"
                class="format-btn strikethrough">
                <s>S</s>
            </button>
            <button type="button" (click)="insertCode()" title="Kod Formatı" class="format-btn">
                &lt;/&gt;
            </button>
            <button type="button" (click)="toggleFormat('subscript')" title="Alt İndis" class="format-btn">
                X<sub>2</sub>
            </button>
            <button type="button" (click)="toggleFormat('superscript')" title="Üst İndis" class="format-btn">
                X<sup>2</sup>
            </button>
        </div>

        <!-- Renk Seçiciler -->
        <div class="toolbar-group">
            <div class="color-picker-section">
                <label for="textColorPicker">Metin Rengi:</label>
                <div class="color-picker-container">
                    <input type="color" id="textColorPicker" #textColorPicker
                        (change)="applyTextColor(textColorPicker.value)" value="#000000" title="Metin rengini seçin"
                        class="color-picker-input">
                    <button type="button" (click)="openTextColorPicker()" class="color-preview-btn"
                        [style.background-color]="currentTextColor" title="Metin Rengi">
                        A
                    </button>
                </div>
            </div>

            <div class="color-picker-section">
                <label for="bgColorPicker">Arka Plan:</label>
                <div class="color-picker-container">
                    <input type="color" id="bgColorPicker" #bgColorPicker
                        (change)="applyBackgroundColor(bgColorPicker.value)" value="#FFFF00"
                        title="Arka plan rengini seçin" class="color-picker-input">
                    <button type="button" (click)="openBgColorPicker()" class="color-preview-btn bg-preview"
                        [style.background-color]="currentBgColor === 'transparent' ? '#ffffff' : currentBgColor"
                        [style.background-image]="currentBgColor === 'transparent' ? 'linear-gradient(45deg, #ccc 25%, transparent 25%), linear-gradient(-45deg, #ccc 25%, transparent 25%), linear-gradient(45deg, transparent 75%, #ccc 75%), linear-gradient(-45deg, transparent 75%, #ccc 75%)' : 'none'"
                        [style.background-size]="currentBgColor === 'transparent' ? '8px 8px' : 'auto'"
                        [style.background-position]="currentBgColor === 'transparent' ? '0 0, 0 4px, 4px -4px, -4px 0px' : 'auto'"
                        title="Arka Plan Rengi">
                        A
                    </button>
                    <button type="button" (click)="clearBackgroundColor()" class="clear-bg-btn"
                        title="Arka planı temizle">
                        ✕
                    </button>
                </div>
            </div>
        </div>

        <!-- Hizalama -->
        <div class="toolbar-group">
            <button type="button" (click)="alignText('Left')" title="Sola Hizala" class="align-btn">
                ◀ Sola
            </button>
            <button type="button" (click)="alignText('Center')" title="Ortala" class="align-btn">
                ◆ Ortala
            </button>
            <button type="button" (click)="alignText('Right')" title="Sağa Hizala" class="align-btn">
                Sağa ▶
            </button>
            <button type="button" (click)="alignText('Full')" title="İki Yana Yasla" class="align-btn">
                ◀▶ Yasla
            </button>
        </div>

        <!-- Listeler -->
        <div class="toolbar-group">
            <button type="button" (click)="insertList('unordered')" title="Madde İşaretli Liste" class="list-btn">
                ● Liste
            </button>
            <button type="button" (click)="insertList('ordered')" title="Numaralı Liste" class="list-btn">
                1. Liste
            </button>
        </div>

        <!-- Ekleme Araçları -->
        <div class="toolbar-group">
            <button type="button" (click)="insertBlockquote()" title="Alıntı Ekle" class="insert-btn">
                💬 Alıntı
            </button>
            <button type="button" (click)="insertTable()" title="Tablo Ekle" class="insert-btn">
                ⊞ Tablo
            </button>
            <button type="button" (click)="insertLink()" title="Link Ekle" class="insert-btn">
                🔗 Link
            </button>
            <button type="button" (click)="insertImage()" title="Resim Ekle" class="insert-btn">
                🖼 Resim
            </button>
            <button type="button" (click)="insertHorizontalRule()" title="Yatay Çizgi" class="insert-btn">
                ➖ Çizgi
            </button>
        </div>

        <!-- Özel Araçlar -->
        <div class="toolbar-group">
            <button type="button" (click)="undo()" title="Geri Al (Ctrl+Z)" class="tool-btn">
                ↶ Geri Al
            </button>
            <button type="button" (click)="redo()" title="İleri Al (Ctrl+Y)" class="tool-btn">
                ↷ İleri Al
            </button>
            <button type="button" (click)="showOutput = !showOutput" title="HTML Çıktısını Göster/Gizle"
                class="tool-btn">
                📄 HTML Çıktı
            </button>
        </div>

        <!-- Word Temizleme Araçları -->
        <div class="toolbar-group">
            <button type="button" (click)="removeBackgrounds()" title="Arka Plan Renklerini Kaldır" class="clean-btn">
                🎨 Arka Plan Temizle
            </button>
            <button type="button" (click)="quickCleanFormatting()" title="Word Formatını Temizle" class="clean-btn">
                🗑️ Word Temizle
            </button>
        </div>
    </div>

    <!-- Editor Alanı -->
    <div class="editor-wrapper">
        <div #editor class="editor-content word-compatible" contenteditable="true" [style.min-height]="minHeight"
            [class.active]="isEditorActive" spellcheck="true" dir="ltr">
        </div>
    </div>

    <!-- İstatistikler ve Durum -->
    <div class="editor-status">
        <div class="status-left">
            <span class="editor-info">CKEditor Benzeri Güçlü Editör</span>
            <button type="button" (click)="togglePreview()" class="preview-toggle-btn" [class.active]="isPreviewMode"
                title="Önizleme Modunu Aç/Kapat">
                {{ isPreviewMode ? '✏️ Düzenle' : '👁️ Önizleme' }}
            </button>
        </div>
        <div class="statistics">
            <span class="stat-item">📄 Kelime: {{wordCount}}</span>
            <span class="stat-item">🔤 Karakter: {{charCount}}</span>
            <span class="stat-item">📝 Paragraf: {{paragraphCount}}</span>
            @if (selectedText) {
            <span class="stat-item">✂️ Seçili: {{selectedText.length}}</span>
            }
        </div>
    </div>

    <!-- Preview Modu -->
    @if(isPreviewMode){
    <div class="preview-container">
        <div class="preview-header">
            <h4>🔍 Önizleme - Gerçek Görünüm</h4>
            <p>Bu alan, içeriğinizin son kullanıcıya nasıl görüneceğini gösterir.</p>
        </div>
        <div class="preview-content" [innerHTML]="content"></div>
    </div>
    }

    <!-- HTML Çıktı Paneli -->
    @if (showOutput) {
    <div class="output-panel">
        <div class="output-header">
            <h4>📄 HTML Çıktısı</h4>
            <div class="output-actions">
                <button type="button" (click)="showOutput = false" class="close-btn" title="Paneli Kapat">
                    ✕ Kapat
                </button>
            </div>
        </div>
        <div class="output-content">
            <textarea class="html-output" readonly [value]="content" rows="15"></textarea>
        </div>
        <div class="output-info">
            <small>📋 Bu HTML çıktısını kopyalayıp herhangi bir web sayfasında kullanabilirsiniz.</small>
        </div>
    </div>
    }
</div>