<div class="editor-container" [class.dark-mode]="darkMode">
    <!-- Advanced Toolbar -->
    <div class="toolbar">
        <!-- Stil SeÃ§imi -->
        <div class="toolbar-group">
            <select (change)="applyHeading($any($event.target).value)" class="heading-select">
                @for (heading of headingLevels; track $index) {
                <option [value]="heading.value">{{heading.text}}</option>
                }
            </select>
        </div>

        <!-- Font Ailesi -->
        <div class="toolbar-group">
            <select (change)="applyFontFamily($any($event.target).value)" [value]="currentFontFamily"
                class="font-family-select">
                @for (font of fontFamilies; track $index) {
                <option [value]="font">{{font}}</option>
                }
            </select>
        </div>

        <!-- Font Boyutu -->
        <div class="toolbar-group">
            <select (change)="applyFontSize(+$any($event.target).value)" [value]="currentFontSize"
                class="font-size-select">
                @for (size of fontSizes; track $index) {
                <option [value]="size">{{size}}</option>
                }
            </select>
        </div>

        <!-- Format ButonlarÄ± -->
        <div class="toolbar-group">
            <button type="button" (click)="toggleFormat('bold')" title="KalÄ±n (Ctrl+B)" class="format-btn bold">
                <strong>B</strong>
            </button>
            <button type="button" (click)="toggleFormat('italic')" title="Ä°talik (Ctrl+I)" class="format-btn italic">
                <em>I</em>
            </button>
            <button type="button" (click)="toggleFormat('underline')" title="AltÄ± Ã‡izili (Ctrl+U)"
                class="format-btn underline">
                <u>U</u>
            </button>
            <button type="button" (click)="toggleFormat('strikeThrough')" title="ÃœstÃ¼ Ã‡izili"
                class="format-btn strikethrough">
                <s>S</s>
            </button>
            <button type="button" (click)="insertCode()" title="Kod FormatÄ±" class="format-btn">
                &lt;/&gt;
            </button>
            <button type="button" (click)="toggleFormat('subscript')" title="Alt Ä°ndis" class="format-btn">
                X<sub>2</sub>
            </button>
            <button type="button" (click)="toggleFormat('superscript')" title="Ãœst Ä°ndis" class="format-btn">
                X<sup>2</sup>
            </button>
        </div>

        <!-- Renk SeÃ§iciler -->
        <div class="toolbar-group">
            <div class="color-picker-section">
                <label for="textColorPicker">Metin Rengi:</label>
                <div class="color-picker-container">
                    <input type="color" id="textColorPicker" #textColorPicker
                        (change)="applyTextColor(textColorPicker.value)" value="#000000" title="Metin rengini seÃ§in"
                        class="color-picker-input">
                    <button type="button" (click)="openTextColorPicker()" class="color-preview-btn"
                        [style.background-color]="currentTextColor" title="Metin Rengi">
                        A
                    </button>
                </div>
            </div>

            <div class="color-picker-section">
                <label for="bgColorPicker">Arka Plan:</label>
                <div class="color-picker-container">
                    <input type="color" id="bgColorPicker" #bgColorPicker
                        (change)="applyBackgroundColor(bgColorPicker.value)" value="#FFFF00"
                        title="Arka plan rengini seÃ§in" class="color-picker-input">
                    <button type="button" (click)="openBgColorPicker()" class="color-preview-btn bg-preview"
                        [style.background-color]="currentBgColor === 'transparent' ? '#ffffff' : currentBgColor"
                        [style.background-image]="currentBgColor === 'transparent' ? 'linear-gradient(45deg, #ccc 25%, transparent 25%), linear-gradient(-45deg, #ccc 25%, transparent 25%), linear-gradient(45deg, transparent 75%, #ccc 75%), linear-gradient(-45deg, transparent 75%, #ccc 75%)' : 'none'"
                        [style.background-size]="currentBgColor === 'transparent' ? '8px 8px' : 'auto'"
                        [style.background-position]="currentBgColor === 'transparent' ? '0 0, 0 4px, 4px -4px, -4px 0px' : 'auto'"
                        title="Arka Plan Rengi">
                        A
                    </button>
                    <button type="button" (click)="clearBackgroundColor()" class="clear-bg-btn"
                        title="Arka planÄ± temizle">
                        âœ•
                    </button>
                </div>
            </div>
        </div>

        <!-- Hizalama -->
        <div class="toolbar-group">
            <button type="button" (click)="alignText('Left')" title="Sola Hizala" class="align-btn">
                â—€ Sola
            </button>
            <button type="button" (click)="alignText('Center')" title="Ortala" class="align-btn">
                â—† Ortala
            </button>
            <button type="button" (click)="alignText('Right')" title="SaÄŸa Hizala" class="align-btn">
                SaÄŸa â–¶
            </button>
            <button type="button" (click)="alignText('Full')" title="Ä°ki Yana Yasla" class="align-btn">
                â—€â–¶ Yasla
            </button>
        </div>

        <!-- Listeler -->
        <div class="toolbar-group">
            <button type="button" (click)="insertList('unordered')" title="Madde Ä°ÅŸaretli Liste" class="list-btn">
                â— Liste
            </button>
            <button type="button" (click)="insertList('ordered')" title="NumaralÄ± Liste" class="list-btn">
                1. Liste
            </button>
        </div>

        <!-- Ekleme AraÃ§larÄ± -->
        <div class="toolbar-group">
            <button type="button" (click)="insertBlockquote()" title="AlÄ±ntÄ± Ekle" class="insert-btn">
                ğŸ’¬ AlÄ±ntÄ±
            </button>
            <button type="button" (click)="insertTable()" title="Tablo Ekle" class="insert-btn">
                âŠ Tablo
            </button>
            <button type="button" (click)="insertLink()" title="Link Ekle" class="insert-btn">
                ğŸ”— Link
            </button>
            <button type="button" (click)="insertImage()" title="Resim Ekle" class="insert-btn">
                ğŸ–¼ Resim
            </button>
            <button type="button" (click)="insertHorizontalRule()" title="Yatay Ã‡izgi" class="insert-btn">
                â– Ã‡izgi
            </button>
        </div>

        <!-- Ã–zel AraÃ§lar -->
        <div class="toolbar-group">
            <button type="button" (click)="undo()" title="Geri Al (Ctrl+Z)" class="tool-btn">
                â†¶ Geri Al
            </button>
            <button type="button" (click)="redo()" title="Ä°leri Al (Ctrl+Y)" class="tool-btn">
                â†· Ä°leri Al
            </button>
            <button type="button" (click)="togglePreview()" title="Ã–n Ä°zleme Paneli" 
                class="tool-btn" [class.active]="showPreview">
                ğŸ‘ï¸ Ã–n Ä°zleme
            </button>
            <button type="button" (click)="toggleHtmlOutput()" title="HTML Ã‡Ä±ktÄ± Paneli" 
                class="tool-btn" [class.active]="showOutput">
                ğŸ“„ HTML Ã‡Ä±ktÄ±
            </button>
        </div>

        <!-- Word Temizleme AraÃ§larÄ± -->
        <div class="toolbar-group">
            <button type="button" (click)="removeBackgrounds()" title="Arka Plan Renklerini KaldÄ±r" class="clean-btn">
                ğŸ¨ Arka Plan Temizle
            </button>
            <button type="button" (click)="quickCleanFormatting()" title="Word FormatÄ±nÄ± Temizle" class="clean-btn">
                ğŸ—‘ï¸ Word Temizle
            </button>
        </div>
    </div>

    <!-- Editor AlanÄ± -->
    <div class="editor-wrapper">
        <div #editor class="editor-content word-compatible" contenteditable="true" [style.min-height]="minHeight"
            [class.active]="isEditorActive" spellcheck="true" dir="ltr">
        </div>
    </div>

    <!-- Ä°statistikler ve Durum -->
    <div class="editor-status">
        <div class="status-left">
            <span class="editor-info">CKEditor Benzeri GÃ¼Ã§lÃ¼ EditÃ¶r</span>
            <button type="button" (click)="togglePreview()" class="preview-toggle-btn" [class.active]="isPreviewMode"
                title="Ã–nizleme Modunu AÃ§/Kapat">
                {{ isPreviewMode ? 'âœï¸ DÃ¼zenle' : 'ğŸ‘ï¸ Ã–nizleme' }}
            </button>
        </div>
        <div class="statistics">
            <span class="stat-item">ğŸ“„ Kelime: {{wordCount}}</span>
            <span class="stat-item">ğŸ”¤ Karakter: {{charCount}}</span>
            <span class="stat-item">ğŸ“ Paragraf: {{paragraphCount}}</span>
            @if (selectedText) {
            <span class="stat-item">âœ‚ï¸ SeÃ§ili: {{selectedText.length}}</span>
            }
        </div>
    </div>

    <!-- Preview Modu -->
    <!-- Ã–n Ä°zleme Paneli - Senkronize -->
    @if(showPreview){
    <div class="preview-container">
        <div class="preview-header">
            <h4>ï¿½ï¸ AnlÄ±k Ã–n Ä°zleme</h4>
            <p>Ä°Ã§erik yazarken anlÄ±k olarak gÃ¼ncellenir</p>
            <button type="button" (click)="showPreview = false" class="close-btn" title="Paneli Kapat">
                âœ• Kapat
            </button>
        </div>
        <div class="preview-content" [innerHTML]="previewContent"></div>
    </div>
    }

    <!-- HTML Ã‡Ä±ktÄ± Paneli - Senkronize -->
    @if (showOutput) {
    <div class="output-panel">
        <div class="output-header">
            <h4>ğŸ“„ AnlÄ±k HTML Ã‡Ä±ktÄ±sÄ±</h4>
            <div class="output-actions">
                <button type="button" (click)="copyHtmlOutput()" class="copy-btn" title="HTML Kopyala">
                    ğŸ“‹ Kopyala
                </button>
                <button type="button" (click)="showOutput = false" class="close-btn" title="Paneli Kapat">
                    âœ• Kapat
                </button>
            </div>
        </div>
        <div class="output-content">
            <textarea class="html-output" readonly [value]="htmlOutput" rows="15"></textarea>
        </div>
        <div class="output-info">
            <small>âš¡ Bu HTML Ã§Ä±ktÄ±sÄ± yazarken anlÄ±k olarak gÃ¼ncellenir. KopyalayÄ±p herhangi bir web sayfasÄ±nda kullanabilirsiniz.</small>
        </div>
    </div>
    }
</div>